(function(){function Application(){this.modules=[];this.inits=[];this.el="body";this.unloading=false;this.startInitList=["initRegionChoice","initAuth","initDescItems","initSidebarNav"];this.modulesMap={tariff_order:"TariffOrder",tariff_list:"TariffList","send-sms":"SendSms",homeinternet:"HomeInternet",checknum:"CheckNum",videorent:"Videorent"};this.initWebstoreFunction=function(alias,forceInit){var _this=this;if(typeof _this.wi[alias]=="function"){if(_this.inits.indexOf(alias)==-1||(typeof forceInit!=="undefined"&&forceInit==true)){try{_this.inits.push(alias);_this.wi[alias]()}catch(err){utils.log("error init function "+alias);utils.log(err)}}}};this.moduleInit=function(e,app){var allInit=true;if(typeof app.modules!=="undefined"){_.each(app.modules,function(m){if(typeof m.module!=="undefined"&&m.module!=null){if(m.module.isInit==false){allInit=false}}else{allInit=false}})}if(allInit){app.$el.trigger("allModulesInit",[app])}};this.afterModulesInit=function(e,app){var _this=this;_.each(_this.startInitList,function(alias){_this.initWebstoreFunction(alias)})};this.init=function(){var _this=this;this.wi=new WebstoreInit();_this.$el=$(_this.el);_this.$el.bind("moduleInit",_this.moduleInit);_this.$el.bind("moduleRender",_this.moduleInit);_this.$el.bind("allModulesInit",_this.afterModulesInit);$(window).unload(function(){app.unloading=true});var msections=$(".init-module");for(var idx=0;idx<msections.length;idx++){var melement=$(msections[idx]);var init_module=melement.data("module");if(init_module){var modules=init_module.split(",");var attributes=melement.data();for(var m=0;m<modules.length;m++){var moduleName=utils.trim(modules[m]);var mdl={alias:moduleName,options:attributes,el:melement,module:null};eval("mdl.module  = new "+_this.modulesMap[moduleName]+"(attributes)");mdl.module.el=melement;if(typeof mdl.module.init!=="undefined"&&typeof mdl.module.init==="function"){mdl.module.init();mdl.module.isInit=true}if(typeof mdl.module.render!=="undefined"&&typeof mdl.module.render==="function"){mdl.module.render();mdl.module.isRender=true}_this.modules.push(mdl)}}}_.each(_this.startInitList,function(alias){_this.initWebstoreFunction(alias)})};this.renderMessage=function(header,message){$("#app-info__alert-title").html(header);$("#app-info__alert-message").html(message);$.magnificPopup.open({items:{src:"#app-info__alert",type:"inline"},closeBtnInside:false,showCloseBtn:false});$(".app-info__alert-close,.app-info__alert-btn").one("click",function(){$.magnificPopup.close()})}}window.app=new Application();app.init();try{document.cookie="reg="+adrMgr.selectedRegion.synonym+";domain=.rt.ru";document.cookie="rk="+adrMgr.selectedRegion.klRegion+";domain=.rt.ru"}catch(error){}})();