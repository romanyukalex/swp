var cnjQuery=jQuery.noConflict();var CN_ANSWER_UNDER_BLOCK=false;(function(a){a(document).ready(function(){var b=a("body");resizeTextInput();b.on("click",".cn_answer_button, .cn_complain",function(){var c;if(a(this).hasClass("cn_answer_button")===true){if(CN_ANSWER_UNDER_BLOCK){if(a(this).parents(".cn_comment_box").find(".cn_answer_input_box").length>0){return false}var g=a(".cn_screen_answer").find(".cn_answer_input_box").clone();a(this).parents(".cn_comment_box").append(g);c=a(this).parents(".cn_comment_box").find(".cn_answer_input_box");c.addClass("cn_answer_input_box_alternative")}else{c=a(".cn_answer_input_box");a(".cn_screen_answer").show()}}if(a(this).hasClass("cn_complain")===true){c=a(".cn_complain_box");a(".cn_screen_complain").show()}var f=a(this).parents(".cn_comment_box").attr("id");var d=a(this).parents(".cn_comment_box").data("cnCommentType");var e=a(this).parents(".cn_main_comment_block").data("cnMainCommentId")||a(this).parents(".cn_comment_box").data("cnMainCommentId");var i=a(this).parents(".cn_comment_box").find(".cn_uri").data("cnPageUri")||document.location.pathname+document.location.search;var h=a(this).parents(".cn_comment_box").find(".cn_uri").text()||a("head").find("title").text();c.data("cnParentId",f);c.data("cnCommentType",d);c.data("cnMainCommentId",e);c.data("cnPageUri",i);c.data("cnPageTitle",h);c.find(".cn_complain_input, .cn_enter_answer_input").focus();resizeBox(c)});b.on("click",".cn_answer_close, .cn_complain_close",function(){var c;if(a(this).hasClass("cn_answer_close")===true){if(CN_ANSWER_UNDER_BLOCK){c=a(this).parents(".cn_comment_box").find(".cn_answer_input_box");c.remove();return false}else{c=a(".cn_answer_input_box");a(".cn_screen_answer").hide()}}if(a(this).hasClass("cn_complain_close")===true){c=a(".cn_complain_box");a(".cn_screen_complain").hide()}c.data("cnParentId","");c.data("cnCommentType","");c.data("cnMainCommentId","");c.data("cnPageUri","");c.data("cnPageTitle","")});b.on("click",".cn_delete_button",function(){var f=a(".cn_delete_confirm_block");a(".cn_screen_delete_confirm").show();var e=a(this).parents(".cn_comment_box").attr("id");var c=a(this).parents(".cn_comment_box").data("cnCommentType");var d=a(this).parents(".cn_main_comment_block").data("cnMainCommentId")||a(this).parents(".cn_comment_box").data("cnMainCommentId");f.data("cnCommentId",e);f.data("cnCommentType",c);f.data("cnMainCommentId",d)});b.on("click",".cn_delete_confirm_cancel",function(){var c=a(".cn_delete_confirm_block");a(".cn_screen_delete_confirm").hide();c.data("cnCommentId","");c.data("cnCommentType","");c.data("cnMainCommentId","")});b.on("click",".cn_social_button",function(f){f.preventDefault();var g=(screen.width-800)/2;var d=(screen.height-600)/2;var c=a(this).data("cnLink");window.open(c,"authorize","width=840, height=620, top="+d+", left="+g+"")});b.on("click",".cn_show_answer_button",function(){var c=a(this).next().next(".cn_answer_hidden");c.css({visibility:"visible",height:"auto",overflow:"auto"});a(this).hide();a(this).next().show()});b.on("click",".cn_hide_answer_button",function(){var c=a(this).next(".cn_answer_hidden");c.removeAttr("style");a(this).hide();a(this).prev().show()});b.on("click",".cn_options_button",function(){var d=a(this).parent();var c=a(this).next(".cn_options_box");if(c.is(":visible")===false){a(this).addClass("cn_options_button_hover");c.show();d.css({display:"block"})}else{a(this).removeClass("cn_options_button_hover");c.hide();d.removeAttr("style")}});b.on("input",".cn_complain_input",function(){var d=a(".cn_length_string");var c=a(this).val();d.text(c.length+"/150");if(c.length>150){d.css({color:"red"})}else{d.removeAttr("style")}});b.on("click",".cn_share_box span",function(f){f.preventDefault();var g=(screen.width-800)/2;var d=(screen.height-400)/2;var c=a(this).data("cnSh");window.open(c,"share","width=840, height=420, top="+d+", left="+g+"")});b.on("input",".cn_enter_text_input",function(){this.style.height="auto";this.style.height=this.scrollHeight+"px"});b.on("input",".cn_enter_answer_input, .cn_complain_input",function(){if(this.scrollHeight<=Math.round((window.innerHeight/100*60)-(a(this).next().height()|0))){this.style.height="auto";this.style.height=this.scrollHeight+"px"}else{this.style.overflow="auto";this.style.height=Math.round((window.innerHeight/100*60)-(a(this).next().height()|0))+"px"}});b.on("focus",".cn_enter_text_input",function(){var c=a(".cn_enter_text_submit");visibleButton(c)});b.on("focus",".cn_enter_answer_input",function(){var c;if(CN_ANSWER_UNDER_BLOCK){c=a(this).parents(".cn_comment_box").find(".cn_enter_answer_submit")}else{c=a(".cn_enter_answer_submit")}visibleButton(c)});b.on("focus",".cn_complain_input",function(){var c=a(".cn_complain_submit");visibleButton(c)});b.on("click",".cn_more_text",function(){var c=this.previousSibling.scrollHeight;a(this).prev().animate({"max-height":c+"px"},200);a(this).removeClass("cn_more_text");a(this).addClass("cn_more_text_close");a(this).prev().children(".cn_more_text_details").animate({height:"0"},400)});b.on("click",".cn_more_text_close",function(){var c=this.previousSibling.className;var d=204;if(c==="cn_content_comment"){d=126}a(this).prev().animate({"max-height":d+"px"},200);a(this).removeClass("cn_more_text_close");a(this).addClass("cn_more_text");a(this).prev().children(".cn_more_text_details").animate({height:"100px"},400)});b.on("click",".cn_more_text_details",function(){var c=this.parentNode.scrollHeight;if(c!==undefined&&c!=null){a(this).parent().next().removeClass("cn_more_text");a(this).parent().next().addClass("cn_more_text_close");a(this).parent().animate({"max-height":c+"px"},200);a(this).animate({height:"0"},400)}});b.on("click",".cn_name_quote",function(){var e=a(this).data("parentId");var c=a("#"+e);var d=c.offset().top-200;c.addClass("cn_animate");c.css({"border-left-color":"#ffc004"});a("html,body").stop(true,true).animate({scrollTop:d},1000);setTimeout(function(){a("#"+e).removeAttr("style")},2000)})})})(cnjQuery);function visibleButton(a){a.css({visibility:"visible"}).animate({opacity:"1"},400)}function hiddenButton(a){a.css({opacity:"0",visibility:"hidden"})}function resizeTextInput(){var b=cnjQuery(".cn_enter_text_input");if(b.html()!==""&&b.length>0){b[0].style.height="auto";b[0].style.height=b[0].scrollHeight+"px";var a=cnjQuery(".cn_enter_text_submit");visibleButton(a)}}function cnMoreText(b){var a=function(c){if(c.scrollHeight>204){if(cnjQuery(c).next(".cn_more_text").length===0&&cnjQuery(c).next(".cn_more_text_close").length===0){cnjQuery(c).after('<div class="cn_more_text"></div>');cnjQuery(c).append('<div class="cn_more_text_details"></div>')}}};b.each(function(c,d){a(d);if(cnjQuery(d).find("img").length>0){cnjQuery(d).find("img").on("load",function(){a(d)})}})}function cnMoreTextPanel(b){var a=function(c){if(c.scrollHeight>126){if(cnjQuery(c).next(".cn_more_text").length===0&&cnjQuery(c).next(".cn_more_text_close").length===0){cnjQuery(c).after('<div class="cn_more_text"></div>');cnjQuery(c).append('<div class="cn_more_text_details"></div>')}}};b.each(function(c,d){a(d);if(cnjQuery(d).find("img").length>0){cnjQuery(d).find("img").on("load",function(){a(d)})}})}function sortAnswer(){function b(d,e){return d.time-e.time}function c(g){var e=[];var d=[];g.children(".cn_comment_box").each(function(h,j){e[h]={value:j,time:cnjQuery(this).find(".cn_date").data("timeSecond")}});e.sort(b);for(var f=0;f<e.length;f++){d[f]=e[f].value}return d}var a=cnjQuery(".cn_last_answer");a.each(function(){var d=c(cnjQuery(this));cnjQuery(this).empty().append(d)})}function noticeModal(a,b){var c=cnjQuery(".cn_block_notice_modal");c.animate({left:"0"},200);c.children(".cn_notice_modal").html('<div class="cn_notice_modal_'+a+'">'+b+"</div>");c.delay(1500).animate({left:"-280px"},200,function(){c.stop(true,true)})}function resizeBox(a){cnjQuery(window).on("resize",function(){var b=a.find("textarea");var c=cnjQuery(this).height();if(b[0].scrollHeight>=Math.round((c/100*60)-(b.next().height()|0))){b.height((c/100*60)-(b.next().height()|0))}else{b.height(b[0].scrollHeight)}})};